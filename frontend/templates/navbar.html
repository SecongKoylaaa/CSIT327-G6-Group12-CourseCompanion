<!-- NAVBAR -->
<nav class="navbar">
  <div class="nav-left">
    <a href="{% url 'home' %}" class="logo-link">
      <img src="https://img.icons8.com/ios-filled/50/ff4500/handshake.png" alt="logo" class="logo">
      <span class="logo-text">Course Companion</span>
    </a>
  </div>

  <div class="nav-center">
    <form action="{% url 'home' %}" method="get" class="search-form">
      <input type="text" name="search" class="search-bar" placeholder="Search posts by title..." value="{{ search_query|default:'' }}">
      <button type="submit" class="search-btn" aria-label="Search">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
      </button>
    </form>
  </div>

  <div class="nav-right">
    <a href="{% url 'create-post-text' %}" class="create-btn">+ Create</a>

    <div class="profile-dropdown">
      <button class="profile-btn">
        {% if profile_picture_url %}
          <img src="{{ profile_picture_url }}" class="profile-pic">
        {% else %}
          <span style="font-size: 20px;">ðŸ‘¤</span>
        {% endif %}
      </button>
      <div class="dropdown-content">
        <a href="{% url 'profile_page' %}">View Profile</a>
        <a href="{% url 'logout' %}">Logout</a>
      </div>
    </div>
  </div>
</nav>

<!-- ======================= PROFILE DROPDOWN SCRIPT ======================= -->
<script>
document.addEventListener("DOMContentLoaded", function() {
  const dropdown = document.querySelector(".profile-dropdown");
  const btn = dropdown.querySelector(".profile-btn");
  const menu = dropdown.querySelector(".dropdown-content");

  btn.addEventListener("click", (e) => {
    e.stopPropagation();
    dropdown.classList.toggle("open");
  });

  // Close when clicking outside
  document.addEventListener("click", (e) => {
    if (!dropdown.contains(e.target)) dropdown.classList.remove("open");
  });

  // Close with ESC key
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") dropdown.classList.remove("open");
  });
});
</script>
